(function(){"use strict";var e={3853:function(e,t,i){var s=i(9242),n=i(3396);const r={ref:"main"};function l(e,t,i,s,l,o){const c=(0,n.up)("Navbar"),a=(0,n.up)("Screen");return(0,n.wg)(),(0,n.iD)("main",r,[(0,n.Wm)(c),(0,n.Wm)(a)],512)}var o=i(7139);const c=e=>((0,n.dD)("data-v-2f0faf44"),e=e(),(0,n.Cn)(),e),a={class:"grey darken-3"},h={class:"nav-wrapper"},d=c((()=>(0,n._)("label",{for:"file-input"},[(0,n._)("i",{class:"material-icons white-text"},"download")],-1))),u=c((()=>(0,n._)("a",null,[(0,n._)("i",{class:"material-icons",id:"fill"},"zoom_out_map")],-1))),g=[u],f=c((()=>(0,n._)("a",null,[(0,n._)("i",{id:"oneOne"},"1:1")],-1))),m=[f],w=c((()=>(0,n._)("a",null,[(0,n._)("i",{class:"material-icons",id:"horiz"},"swap_horiz")],-1))),p=[w],v=c((()=>(0,n._)("a",null,[(0,n._)("i",{class:"material-icons",id:"vert"},"swap_vert")],-1))),S=[v],b=c((()=>(0,n._)("i",{class:"material-icons"},"fullscreen",-1))),_=[b];function k(e,t,i,s,r,l){return(0,n.wg)(),(0,n.iD)("nav",a,[(0,n._)("div",h,[(0,n._)("ul",{class:"left",onClick:t[1]||(t[1]=(...e)=>l.screenChooser&&l.screenChooser(...e))},[(0,n._)("li",null,[(0,n._)("input",{type:"file",id:"file-input",accept:"image/*",multiple:"",webkitdirectory:"",directory:"",onChange:t[0]||(t[0]=(...e)=>l.onFileSelecter&&l.onFileSelecter(...e))},null,32),d]),(0,n._)("li",{class:(0,o.C_)({active:"fill"===l.selectedScreen})},g,2),(0,n._)("li",{class:(0,o.C_)({active:"oneOne"===l.selectedScreen})},m,2),(0,n._)("li",{class:(0,o.C_)({active:"horiz"===l.selectedScreen})},p,2),(0,n._)("li",{class:(0,o.C_)({active:"vert"===l.selectedScreen})},S,2)]),l.fullScreen?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("a",{key:0,class:"right",onClick:t[2]||(t[2]=(...e)=>l.fullScreenToggle&&l.fullScreenToggle(...e))},_))])])}var x={computed:{selectedScreen(){return this.$store.getters.selectedScreen},fullScreen(){return this.$store.getters.fullScreen}},methods:{onFileSelecter(e){const t=[...e.target.files].filter((e=>/image/g.test(e.type)));this.$store.dispatch("uploudFiles",t)},screenChooser(e){/fill|horiz|vert|oneOne/g.test(e.target.id)&&this.$store.dispatch("updateSelectedScreen",e.target.id)},fullScreenToggle(){this.$store.dispatch("updateFullScreen")}}},y=i(89);const F=(0,y.Z)(x,[["render",k],["__scopeId","data-v-2f0faf44"]]);var I=F;const C=e=>((0,n.dD)("data-v-e3b9de9a"),e=e(),(0,n.Cn)(),e),$={key:0},O={key:1,class:"lightbox"},D={class:"lightbox-container"},L=C((()=>(0,n._)("svg",{fill:"#fff",height:"48",viewBox:"0 0 24 24",width:"48",xmlns:"http://www.w3.org/2000/svg"},[(0,n._)("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),(0,n._)("path",{d:"M0-.5h24v24H0z",fill:"none"})],-1))),j=[L],z={class:"lightbox-image"},R={id:"canvas",ref:"canvas"},q=["src"],H=C((()=>(0,n._)("svg",{fill:"#fff",height:"48",viewBox:"0 0 24 24",width:"48",xmlns:"http://www.w3.org/2000/svg"},[(0,n._)("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),(0,n._)("path",{d:"M0-.25h24v24H0z",fill:"none"})],-1))),P=[H];function W(e,t,i,s,r,l){return(0,n.wg)(),(0,n.iD)("div",null,[l.selectedFiles.length?((0,n.wg)(),(0,n.iD)("div",O,[(0,n._)("div",D,[l.hasPrev?((0,n.wg)(),(0,n.iD)("div",{key:0,onClick:t[0]||(t[0]=(...e)=>l.prev&&l.prev(...e)),class:"arrow prev"},j)):(0,n.kq)("",!0),(0,n._)("div",z,[(0,n._)("canvas",R,null,512),(0,n._)("img",{src:r.img_link,ref:"pic"},null,8,q)]),l.hasNext?((0,n.wg)(),(0,n.iD)("div",{key:1,onClick:t[1]||(t[1]=(...e)=>l.next&&l.next(...e)),class:"arrow next"},P)):(0,n.kq)("",!0)])])):((0,n.wg)(),(0,n.iD)("div",$,[(0,n._)("h3",null,"Выберите директорию с изображениями"+(0,o.zw)(e.$store.selectedFiles),1)]))])}var N={data(){return{index:+localStorage.getItem("index")||0,classScreen:{fill:!1,oneOne:!1,horiz:!1,vert:!1},img_link:""}},computed:{selectedScreen(){return this.$store.getters.selectedScreen},fullScreen(){return this.$store.getters.fullScreen},selectedFiles(){const e=this.$store.getters.selectedFiles;return e},hasNext(){return this.index+1<this.selectedFiles.length},hasPrev(){return this.index-1>=0}},watch:{selectedScreen:function(e,t){this.classScreen[t]=!1,this.classScreen[e]=!0,this.getLocalImage()},index:function(e){localStorage.setItem("index",e),this.getLocalImage()},selectedFiles:function(){const e=this.$store.getters.selectedFiles;e.length<this.index&&(this.index=0),this.getLocalImage()}},methods:{prev(){this.hasPrev&&(this.index-=1)},next(){this.hasNext&&(this.index+=1)},onKeydown(e){switch(e.key){case"ArrowRight":this.next();break;case"ArrowLeft":this.prev();break;case"ArrowDown":case"ArrowUp":case" ":e.preventDefault();break}},getLocalImage(){this.selectedFiles.length&&(this.img=new Image,this.img.src=window.URL.createObjectURL(this.selectedFiles[this.index]),this.img.onload=()=>{switch(this.imgWidth=this.img.naturalWidth,this.imgHeight=this.img.naturalHeight,this.imgRatio=this.imgWidth/this.imgHeight,this.W=window.innerWidth-17,this.H=window.innerHeight,this.selectedScreen){case"fill":this.width=this.W,this.height=this.H;break;case"oneOne":this.width=this.imgWidth,this.height=this.imgHeight;break;case"horiz":this.width=this.W,this.height=this.width/this.imgRatio;break;case"vert":this.height=this.H,this.width=this.height*this.imgRatio;break}window.URL.revokeObjectURL(this.img.src),this.c=this.$refs.canvas,this.c.width=this.width,this.c.height=this.height,this.ctx=this.c.getContext("2d"),this.ctx.drawImage(this.img,0,0,this.width,this.height),this.img_link=canvas.toDataURL()})}},mounted(){this.$store.dispatch("getImgs"),window.addEventListener("keydown",this.onKeydown),this.classScreen[this.selectedScreen]=!0},unmounted(){window.removeEventListener("keydown",this.onKeydown)}};const T=(0,y.Z)(N,[["render",W],["__scopeId","data-v-e3b9de9a"]]);var A=T,E={components:{Navbar:I,Screen:A},computed:{fullScreen(){return this.$store.getters.fullScreen}},watch:{fullScreen:function(e){e&&(this.openFullscreen(),this.fullScreenToggle())}},methods:{openFullscreen(){this.$refs.main.requestFullscreen?this.$refs.main.requestFullscreen():this.$refs.main.webkitRequestFullscreen?this.$refs.main.webkitRequestFullscreen():this.$refs.main.msRequestFullscreen&&this.$refs.main.msRequestFullscreen()},fullScreenToggle(){this.$store.dispatch("updateFullScreen")}}};const M=(0,y.Z)(E,[["render",l]]);var U=M,K=i(5431);(0,K.z)("/Vue-lightbox/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var B=i(65);const Z="imgdb",V="imgs",G=1;let J;var Q={async getDb(){return new Promise(((e,t)=>{if(J)return e(J);const i=window.indexedDB.open(Z,G);i.onerror=e=>{console.log("Error opening db",e),t("Error")},i.onsuccess=t=>{J=t.target.result,e(J)},i.onupgradeneeded=e=>{let t=e.target.result;t.createObjectStore(V,{autoIncrement:!0,keyPath:"id"})}}))},async getImgs(){let e=await this.getDb();return new Promise((t=>{let i=e.transaction([V],"readonly");i.oncomplete=()=>{t(n)};const s=i.objectStore(V),n=[];s.openCursor().onsuccess=e=>{const t=e.target.result;t&&(n.push(t.value),t.continue())}}))},async getKeys(){let e=await this.getDb();return new Promise((t=>{let i=e.transaction([V],"readonly");i.oncomplete=()=>{t(n)};const s=i.objectStore(V),n=[];s.openCursor().onsuccess=e=>{const t=e.target.result;t&&(n.push(t.key),t.continue())}}))},async saveImgs(e){let t=await this.getDb();const i=await this.getKeys();return new Promise((s=>{let n=t.transaction([V],"readwrite");n.oncomplete=()=>{s()};let r=n.objectStore(V);for(let e of i)r.delete(e);r.put(e)}))}},X=(0,B.MT)({state:{selectedFiles:[],selectedScreen:localStorage.getItem("selectedScreen")||"fill",fullScreen:!1},getters:{selectedFiles:e=>e.selectedFiles,selectedScreen:e=>e.selectedScreen,fullScreen:e=>e.fullScreen},mutations:{setImgs(e,t){e.selectedFiles=t[t.length-1]||[]},uploudFiles(e,t){e.selectedFiles=t},updateSelectedScreen(e,t){e.selectedScreen=t,localStorage.setItem("selectedScreen",t)},updateFullScreen(e){e.fullScreen=!e.fullScreen}},actions:{async getImgs({commit:e}){let t=await Q.getImgs();e("setImgs",t)},async uploudFiles({commit:e},t){await Q.saveImgs(t),e("uploudFiles",t)},updateSelectedScreen({commit:e},t){e("updateSelectedScreen",t)},updateFullScreen({commit:e}){e("updateFullScreen")}}});i(5778);(0,s.ri)(U).use(X).mount("#app")}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var r=t[s]={exports:{}};return e[s].call(r.exports,r,r.exports,i),r.exports}i.m=e,function(){var e=[];i.O=function(t,s,n,r){if(!s){var l=1/0;for(h=0;h<e.length;h++){s=e[h][0],n=e[h][1],r=e[h][2];for(var o=!0,c=0;c<s.length;c++)(!1&r||l>=r)&&Object.keys(i.O).every((function(e){return i.O[e](s[c])}))?s.splice(c--,1):(o=!1,r<l&&(l=r));if(o){e.splice(h--,1);var a=n();void 0!==a&&(t=a)}}return t}r=r||0;for(var h=e.length;h>0&&e[h-1][2]>r;h--)e[h]=e[h-1];e[h]=[s,n,r]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};i.O.j=function(t){return 0===e[t]};var t=function(t,s){var n,r,l=s[0],o=s[1],c=s[2],a=0;if(l.some((function(t){return 0!==e[t]}))){for(n in o)i.o(o,n)&&(i.m[n]=o[n]);if(c)var h=c(i)}for(t&&t(s);a<l.length;a++)r=l[a],i.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return i.O(h)},s=self["webpackChunkvue_lightbox"]=self["webpackChunkvue_lightbox"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=i.O(void 0,[998],(function(){return i(3853)}));s=i.O(s)})();
//# sourceMappingURL=app.2e1091e2.js.map